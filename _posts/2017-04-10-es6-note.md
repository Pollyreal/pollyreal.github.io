---
date: 2017-04-10 21:51:31+00:00
layout: post
title: ECMAScript 6 学习笔记
categories: 文档
tags: 笔记
---

[TOC]
# ECMAScript 6 学习笔记
## 简介
## let和const
### let和var区别
 - let作用域仅在块级作用域内有效。
 - 暂时性死区：只要在块级作用域存在let命令
     ```javascript
     var tmp = 123;
    
    if (true) {
      tmp = 'abc'; // ReferenceError
      let tmp;
    }
     ```
    也意味着typeof不再是个百分之百安全的操作。只要在声明之前，引用该变量，就会报错。反而，一个变量没有被声明，使用typeof不会报错。  
    一下例子是隐蔽的“死区”。
    
    ```javascript
    function bar(x = y, y = 2) {
      return [x, y];
    }
    
    bar(); // 报错
    ```
    ```javascript
    function bar(x = 2, y = x) {
      return [x, y];
    }
    bar(); // [2, 2]
    ```
- let不允许重复声明
- 原本只有**全局作用域**、 **函数作用域**，新增 **函数作用域** 概念。
- 块级作用域的出现，使得获得广泛应用的立即执行函数表达式（IIFE）不再需要。
    ```javascript
    // IIFE 写法
    (function () {
      var tmp = ...;
      ...
    }());
    
    // 块级作用域写法
    {
      let tmp = ...;
      ...
    }
    ```
- 应该避免在块级作用域内声明函数。如果确实需要，也应该写成函数表达式，而不是函数声明语句。

### const命令
只读常量

### ES6 声明变量的六种方法
#### var
#### function
#### let
#### const
#### import
#### class

从ES6开始，全局变量将逐步与顶层对象的属性脱钩。

## 变量的解构赋值
- 不完全解构
- 只要某种数据结构具有 Iterator，都可以采用数组形式的解构赋值
- 解构赋值允许指定默认值
- ES6 内部使用严格相等运算符（===），判断一个位置是否有值
- 如果默认值是一个表达式，那么这个表达式是惰性求值的，即只有在用到的时候，才会求值。
  ```javascript
      function f() {
      console.log('aaa');
    }
    
    let [x = f()] = [1];
  ```
  以上代码因为x能取到值，所以函数f根本不会执行
 - 建议只要有可能，就不要在模式中放置圆括号。
   1. 变量声明语句中，不能带有圆括号。
   ```javascipt
    // 全部报错
    let [(a)] = [1];
    
    let {x: (c)} = {};
    let ({x: c}) = {};
    let {(x: c)} = {};
    let {(x): c} = {};
    
    let { o: ({ p: p }) } = { o: { p: 2 } };
   ```
   2. 函数参数中，模式不能带有圆括号。
   ```javascript
    // 报错
    function f([(z)]) { return z; }
   ```
   3. 赋值语句中，不能将整个模式，或嵌套模式中的一层，放在圆括号之中。
   ```javascript
    // 全部报错
    ({ p: a }) = { p: 42 };
    ([a]) = [5];
   ```
### 用途
#### 交换变量
 ```javascript
 let x = 1;
 let y = 2;

 [x, y] = [y, x];
 ```
#### 从函数返回多个值
#### 函数参数的定义
#### 提取JSON数据
  ```javascript
    let jsonData = {
      id: 42,
      status: "OK",
      data: [867, 5309]
    };
    
    let { id, status, data: number } = jsonData;
    
    console.log(id, status, number);
    // 42, "OK", [867, 5309]
  ```
#### 函数参数的默认值
#### 遍历Map结构
``` javascript
var map = new Map();
map.set('first', 'hello');
map.set('second', 'world');

for (let [key, value] of map) {
  console.log(key + " is " + value);
}
// first is hello
// second is world
```
``` javascript
// 获取键名
for (let [key] of map) {
  // ...
}

// 获取键值
for (let [,value] of map) {
  // ...
}
```
#### 输入模块的指定方法
```javascript
const { SourceMapConsumer, SourceNode } = require("source-map");
```